#-----------------------------------------------------------------------------------------------

# Distribution (PIN)

#-----------------------------------------------------------------------------------------------

message("Distribution...")


df_aggr_pin <- df_weight %>%
  group_by(GEOITEM, PERIOD) %>%
  srvyr::summarise(
    wl01_pin = (survey_mean((wl01 >= 1 & wl01 <= 5), na.rm = TRUE, vartype = vt) * 100),
    wl01_pin_1 = (survey_mean((wl01 >= 1 & wl01 <= 5), na.rm = TRUE, vartype = vt) * 100),
    wl01_pin_2 = (survey_mean((wl01 == 6), na.rm = TRUE, vartype = vt) * 100),
    wl01_pin_3 = (survey_mean((wl01 == 7), na.rm = TRUE, vartype = vt) * 100),
    wl01_pin_4 = (survey_mean((wl01 == 8), na.rm = TRUE, vartype = vt) * 100),
    wl01_pin_5 = (survey_mean((wl01 %in% c(9, 10)), na.rm = TRUE, vartype = vt) * 100),
    wl16_pin = (survey_mean((wl16 >= 1 & wl16 <= 5), na.rm = TRUE, vartype = vt) * 100),
    wl16_pin_1 = (survey_mean((wl16 >= 1 & wl16 <= 5), na.rm = TRUE, vartype = vt) * 100),
    wl16_pin_2 = (survey_mean((wl16 == 6), na.rm = TRUE, vartype = vt) * 100),
    wl16_pin_3 = (survey_mean((wl16 == 7), na.rm = TRUE, vartype = vt) * 100),
    wl16_pin_4 = (survey_mean((wl16 == 8), na.rm = TRUE, vartype = vt) * 100),
    wl16_pin_5 = (survey_mean((wl16 %in% c(9, 10)), na.rm = TRUE, vartype = vt) * 100),
    bo06_pin = (survey_mean((bo06 >= 1 & bo06 <= 5), na.rm = TRUE, vartype = vt) * 100),
    bo06_pin_1 = (survey_mean((bo06 >= 1 & bo06 <= 5), na.rm = TRUE, vartype = vt) * 100),
    bo06_pin_2 = (survey_mean((bo06 == 6), na.rm = TRUE, vartype = vt) * 100),
    bo06_pin_3 = (survey_mean((bo06 == 7), na.rm = TRUE, vartype = vt) * 100),
    bo06_pin_4 = (survey_mean((bo06 == 8), na.rm = TRUE, vartype = vt) * 100),
    bo06_pin_5 = (survey_mean((bo06 %in% c(9, 10)), na.rm = TRUE, vartype = vt) * 100),
    dv01_pin = (survey_mean((dv01 >= 1 & dv01 <= 5), na.rm = TRUE, vartype = vt) * 100),
    dv01_pin_1 = (survey_mean((dv01 >= 1 & dv01 <= 5), na.rm = TRUE, vartype = vt) * 100),
    dv01_pin_2 = (survey_mean((dv01 == 6), na.rm = TRUE, vartype = vt) * 100),
    dv01_pin_3 = (survey_mean((dv01 == 7), na.rm = TRUE, vartype = vt) * 100),
    dv01_pin_4 = (survey_mean((dv01 == 8), na.rm = TRUE, vartype = vt) * 100),
    dv01_pin_5 = (survey_mean((dv01 %in% c(9, 10)), na.rm = TRUE, vartype = vt) * 100),
    sc02_pin = (survey_mean((sc02 >= 1 & sc02 <= 5), na.rm = TRUE, vartype = vt) * 100),
    sc02_pin_1 = (survey_mean((sc02 >= 1 & sc02 <= 5), na.rm = TRUE, vartype = vt) * 100),
    sc02_pin_2 = (survey_mean((sc02 == 6), na.rm = TRUE, vartype = vt) * 100),
    sc02_pin_3 = (survey_mean((sc02 == 7), na.rm = TRUE, vartype = vt) * 100),
    sc02_pin_4 = (survey_mean((sc02 == 8), na.rm = TRUE, vartype = vt) * 100),
    sc02_pin_5 = (survey_mean((sc02 %in% c(9, 10)), na.rm = TRUE, vartype = vt) * 100),
    dv06_pin = (survey_mean((dv06 >= 1 & dv06 <= 5), na.rm = TRUE, vartype = vt) * 100),
    dv06_pin_1 = (survey_mean((dv06 >= 1 & dv06 <= 5), na.rm = TRUE, vartype = vt) * 100),
    dv06_pin_2 = (survey_mean((dv06 == 6), na.rm = TRUE, vartype = vt) * 100),
    dv06_pin_3 = (survey_mean((dv06 == 7), na.rm = TRUE, vartype = vt) * 100),
    dv06_pin_4 = (survey_mean((dv06 == 8), na.rm = TRUE, vartype = vt) * 100),
    dv06_pin_5 = (survey_mean((dv06 %in% c(9, 10)), na.rm = TRUE, vartype = vt) * 100),
    dv10_pin_1 = (survey_mean((dv10 >= 1 & dv10 <= 5), na.rm = TRUE, vartype = vt) * 100),
    dv10_pin_2 = (survey_mean((dv10 == 6), na.rm = TRUE, vartype = vt) * 100),
    dv10_pin_3 = (survey_mean((dv10 == 7), na.rm = TRUE, vartype = vt) * 100),
    dv10_pin_4 = (survey_mean((dv10 == 8), na.rm = TRUE, vartype = vt) * 100),
    dv10_pin_5 = (survey_mean((dv10 %in% c(9, 10)), na.rm = TRUE, vartype = vt) * 100),
    zw12_pin_1 = (survey_mean((zw12 >= 1 & zw12 <= 5), na.rm = TRUE, vartype = vt) * 100),
    zw12_pin_2 = (survey_mean((zw12 == 6), na.rm = TRUE, vartype = vt) * 100),
    zw12_pin_3 = (survey_mean((zw12 == 7), na.rm = TRUE, vartype = vt) * 100),
    zw12_pin_4 = (survey_mean((zw12 == 8), na.rm = TRUE, vartype = vt) * 100),
    zw12_pin_5 = (survey_mean((zw12 %in% c(9, 10)), na.rm = TRUE, vartype = vt) * 100),
    wl09_pin1 = (survey_mean((wl09 == 1), na.rm = TRUE, vartype = vt) * 100),
    wl09_pin2 = (survey_mean((wl09 == 2), na.rm = TRUE, vartype = vt) * 100),
    wl09_pin3 = (survey_mean((wl09 == 3), na.rm = TRUE, vartype = vt) * 100),
    wl09_pin4 = (survey_mean((wl09 == 4), na.rm = TRUE, vartype = vt) * 100),
    wl09_pin5 = (survey_mean((wl09 == 5), na.rm = TRUE, vartype = vt) * 100),
    wl04_pin1 = (survey_mean((wl04 == 1), na.rm = TRUE, vartype = vt) * 100),
    wl04_pin2 = (survey_mean((wl04 == 2), na.rm = TRUE, vartype = vt) * 100),
    wl04_pin3 = (survey_mean((wl04 == 3), na.rm = TRUE, vartype = vt) * 100),
    wl04_pin4 = (survey_mean((wl04 == 4), na.rm = TRUE, vartype = vt) * 100),
    wl04_pin5 = (survey_mean((wl04 == 5), na.rm = TRUE, vartype = vt) * 100),
    wl18_pin1 = (survey_mean((wl18 == 1), na.rm = TRUE, vartype = vt) * 100),
    wl18_pin2 = (survey_mean((wl18 == 2), na.rm = TRUE, vartype = vt) * 100),
    wl18_pin3 = (survey_mean((wl18 == 3), na.rm = TRUE, vartype = vt) * 100),
    wl18_pin4 = (survey_mean((wl18 == 4), na.rm = TRUE, vartype = vt) * 100),
    wl18_pin5 = (survey_mean((wl18 == 5), na.rm = TRUE, vartype = vt) * 100),
    wl05_pin1 = (survey_mean((wl05 == 1), na.rm = TRUE, vartype = vt) * 100),
    wl05_pin2 = (survey_mean((wl05 == 2), na.rm = TRUE, vartype = vt) * 100),
    wl05_pin3 = (survey_mean((wl05 == 3), na.rm = TRUE, vartype = vt) * 100),
    wl05_pin4 = (survey_mean((wl05 == 4), na.rm = TRUE, vartype = vt) * 100),
    wl05_pin5 = (survey_mean((wl05 == 5), na.rm = TRUE, vartype = vt) * 100),
    zw01_0_pin1 = (survey_mean((zw01_0 == 1), na.rm = TRUE, vartype = vt) * 100),
    zw01_0_pin2 = (survey_mean((zw01_0 == 2), na.rm = TRUE, vartype = vt) * 100),
    zw01_0_pin3 = (survey_mean((zw01_0 == 3), na.rm = TRUE, vartype = vt) * 100),
    zw01_0_pin4 = (survey_mean((zw01_0 == 4), na.rm = TRUE, vartype = vt) * 100),
    zw01_1_pin1 = (survey_mean((zw01_1 == 1), na.rm = TRUE, vartype = vt) * 100),
    zw01_1_pin2 = (survey_mean((zw01_1 == 2), na.rm = TRUE, vartype = vt) * 100),
    zw01_1_pin3 = (survey_mean((zw01_1 == 3), na.rm = TRUE, vartype = vt) * 100),
    zw01_1_pin4 = (survey_mean((zw01_1 == 4), na.rm = TRUE, vartype = vt) * 100),
    zw01_2_pin1 = (survey_mean((zw01_2 == 1), na.rm = TRUE, vartype = vt) * 100),
    zw01_2_pin2 = (survey_mean((zw01_2 == 2), na.rm = TRUE, vartype = vt) * 100),
    zw01_2_pin3 = (survey_mean((zw01_2 == 3), na.rm = TRUE, vartype = vt) * 100),
    zw01_2_pin4 = (survey_mean((zw01_2 == 4), na.rm = TRUE, vartype = vt) * 100),
    zw01_3_pin1 = (survey_mean((zw01_3 == 1), na.rm = TRUE, vartype = vt) * 100),
    zw01_3_pin2 = (survey_mean((zw01_3 == 2), na.rm = TRUE, vartype = vt) * 100),
    zw01_3_pin3 = (survey_mean((zw01_3 == 3), na.rm = TRUE, vartype = vt) * 100),
    zw01_3_pin4 = (survey_mean((zw01_3 == 4), na.rm = TRUE, vartype = vt) * 100),
    zw01_4_pin1 = (survey_mean((zw01_4 == 1), na.rm = TRUE, vartype = vt) * 100),
    zw01_4_pin2 = (survey_mean((zw01_4 == 2), na.rm = TRUE, vartype = vt) * 100),
    zw01_4_pin3 = (survey_mean((zw01_4 == 3), na.rm = TRUE, vartype = vt) * 100),
    zw01_4_pin4 = (survey_mean((zw01_4 == 4), na.rm = TRUE, vartype = vt) * 100),
    zw01_5_pin1 = (survey_mean((zw01_5 == 1), na.rm = TRUE, vartype = vt) * 100),
    zw01_5_pin2 = (survey_mean((zw01_5 == 2), na.rm = TRUE, vartype = vt) * 100),
    zw01_5_pin3 = (survey_mean((zw01_5 == 3), na.rm = TRUE, vartype = vt) * 100),
    zw01_5_pin4 = (survey_mean((zw01_5 == 4), na.rm = TRUE, vartype = vt) * 100),
    zw01_6_pin1 = (survey_mean((zw01_6 == 1), na.rm = TRUE, vartype = vt) * 100),
    zw01_6_pin2 = (survey_mean((zw01_6 == 2), na.rm = TRUE, vartype = vt) * 100),
    zw01_6_pin3 = (survey_mean((zw01_6 == 3), na.rm = TRUE, vartype = vt) * 100),
    zw01_6_pin4 = (survey_mean((zw01_6 == 4), na.rm = TRUE, vartype = vt) * 100),
    zw10_0_pin1 = (survey_mean((zw10_0 == 1), na.rm = TRUE, vartype = vt) * 100),
    zw10_0_pin2 = (survey_mean((zw10_0 == 2), na.rm = TRUE, vartype = vt) * 100),
    zw10_0_pin3 = (survey_mean((zw10_0 == 3), na.rm = TRUE, vartype = vt) * 100),
    zw10_1_pin1 = (survey_mean((zw10_1 == 1), na.rm = TRUE, vartype = vt) * 100),
    zw10_1_pin2 = (survey_mean((zw10_1 == 2), na.rm = TRUE, vartype = vt) * 100),
    zw10_1_pin3 = (survey_mean((zw10_1 == 3), na.rm = TRUE, vartype = vt) * 100),
    zw10_2_pin1 = (survey_mean((zw10_2 == 1), na.rm = TRUE, vartype = vt) * 100),
    zw10_2_pin2 = (survey_mean((zw10_2 == 2), na.rm = TRUE, vartype = vt) * 100),
    zw10_2_pin3 = (survey_mean((zw10_2 == 3), na.rm = TRUE, vartype = vt) * 100),
    wl14_1 = (survey_mean((wl14 == 1), na.rm = TRUE, vartype = vt) * 100),
    wl14_2 = (survey_mean((wl14 == 2), na.rm = TRUE, vartype = vt) * 100),
    wl14_3 = (survey_mean((wl14 == 3), na.rm = TRUE, vartype = vt) * 100),
    wl06_pin1 = (survey_mean((wl06 == 1), na.rm = TRUE, vartype = vt) * 100),
    wl06_pin2 = (survey_mean((wl06 == 2), na.rm = TRUE, vartype = vt) * 100),
    wl06_pin3 = (survey_mean((wl06 == 3), na.rm = TRUE, vartype = vt) * 100),
    wl06_pin4 = (survey_mean((wl06 == 4), na.rm = TRUE, vartype = vt) * 100),
    zw03_pin1 = (survey_mean((zw03 == 1), na.rm = TRUE, vartype = vt) * 100),
    zw03_pin2 = (survey_mean((zw03 == 2), na.rm = TRUE, vartype = vt) * 100),
    zw03_pin3 = (survey_mean((zw03 == 3), na.rm = TRUE, vartype = vt) * 100),
    zw04_pin1 = (survey_mean((zw04 == 1), na.rm = TRUE, vartype = vt) * 100),
    zw04_pin2 = (survey_mean((zw04 == 2), na.rm = TRUE, vartype = vt) * 100),
    zw04_pin3 = (survey_mean((zw04 == 3), na.rm = TRUE, vartype = vt) * 100),
    zw04_pin4 = (survey_mean((zw04 == 4), na.rm = TRUE, vartype = vt) * 100),
    zw20_pin1 = (survey_mean((zw20 == 1), na.rm = TRUE, vartype = vt) * 100),
    zw20_pin2 = (survey_mean((zw20 == 2), na.rm = TRUE, vartype = vt) * 100),
    zw20_pin3 = (survey_mean((zw20 == 3), na.rm = TRUE, vartype = vt) * 100),
    zw20_pin4 = (survey_mean((zw20 == 4), na.rm = TRUE, vartype = vt) * 100),
    zw20_pin5 = (survey_mean((zw20 == 5), na.rm = TRUE, vartype = vt) * 100),
    part_brt_pin1 = (survey_mean((part_brt == 1), na.rm = TRUE, vartype = vt) * 100),
    part_brt_pin2 = (survey_mean((part_brt == 2), na.rm = TRUE, vartype = vt) * 100),
    part_brt_pin3 = (survey_mean((part_brt == 3), na.rm = TRUE, vartype = vt) * 100),
    part_brt_pin4 = (survey_mean((part_brt == 4), na.rm = TRUE, vartype = vt) * 100),
    # part_brt_pin5=(survey_mean((part_brt==0), na.rm=TRUE,vartype=vt) *100),
    part_brt_pin5 = 100 - (part_brt_pin1 + part_brt_pin2 + part_brt_pin3 + part_brt_pin4),
    part_vw_pin1 = (survey_mean((part_vw == 1), na.rm = TRUE, vartype = vt) * 100),
    part_vw_pin2 = (survey_mean((part_vw == 2), na.rm = TRUE, vartype = vt) * 100),
    part_vw_pin3 = (survey_mean((part_vw == 3), na.rm = TRUE, vartype = vt) * 100),
    part_vw_pin4 = (survey_mean((part_vw == 4), na.rm = TRUE, vartype = vt) * 100),
    # part_vw_pin5=(survey_mean((part_vw==0), na.rm=TRUE,vartype=vt) *100),
    part_vw_pin5 = 100 - (part_vw_pin1 + part_vw_pin2 + part_vw_pin3 + part_vw_pin4),
    zw07_pin1 = (survey_mean((zw07 == 1), na.rm = TRUE, vartype = vt) * 100),
    zw07_pin2 = (survey_mean((zw07 == 2), na.rm = TRUE, vartype = vt) * 100),
    zw07_pin3 = (survey_mean((zw07 == 3), na.rm = TRUE, vartype = vt) * 100),
    zw07_pin4 = (survey_mean((zw07 == 4), na.rm = TRUE, vartype = vt) * 100),
    zw09_pin1 = (survey_mean((zw09 == 1), na.rm = TRUE, vartype = vt) * 100),
    zw09_pin2 = (survey_mean((zw09 == 2), na.rm = TRUE, vartype = vt) * 100),
    zw09_pin3 = (survey_mean((zw09 == 3), na.rm = TRUE, vartype = vt) * 100),
    zw09_pin4 = (survey_mean((zw09 == 4), na.rm = TRUE, vartype = vt) * 100),
    mz_lev1 = (survey_mean((zw06_0 == 1), na.rm = TRUE, vartype = vt) * 100),
    mz_lev2 = (survey_mean((zw06_0 == 2), na.rm = TRUE, vartype = vt) * 100),
    mz_lev3 = (survey_mean((zw06_0 == 3), na.rm = TRUE, vartype = vt) * 100),
    vw_lev1 = (survey_mean((zw06_3 == 1), na.rm = TRUE, vartype = vt) * 100),
    vw_lev2 = (survey_mean((zw06_3 == 2), na.rm = TRUE, vartype = vt) * 100),
    vw_lev3 = (survey_mean((zw06_3 == 3), na.rm = TRUE, vartype = vt) * 100),
    zw06_0 = (survey_mean((zw06_0 < 3), na.rm = TRUE, vartype = vt) * 100),
    zw06_1 = (survey_mean((zw06_1 < 3), na.rm = TRUE, vartype = vt) * 100),
    zw06_2 = (survey_mean((zw06_2 < 3), na.rm = TRUE, vartype = vt) * 100),
    zw06_3 = (survey_mean((zw06_3 < 3), na.rm = TRUE, vartype = vt) * 100),
    zw19_0_pin = (survey_mean((zw19_0 < 3), na.rm = TRUE, vartype = vt) * 100),
    zw19_1_pin = (survey_mean((zw19_1 < 3), na.rm = TRUE, vartype = vt) * 100),
    zw19_2_pin = (survey_mean((zw19_2 < 3), na.rm = TRUE, vartype = vt) * 100),
    zw19_3_pin = (survey_mean((zw19_3 < 3), na.rm = TRUE, vartype = vt) * 100),
    zw19_4_pin = (survey_mean((zw19_4 < 3), na.rm = TRUE, vartype = vt) * 100),
    vz03_0 = (survey_mean((vz03_0 < 3), na.rm = TRUE, vartype = vt) * 100),
    vz03_1 = (survey_mean((vz03_1 < 3), na.rm = TRUE, vartype = vt) * 100),
    vz03_2 = (survey_mean((vz03_2 < 3), na.rm = TRUE, vartype = vt) * 100),
    vz03_3 = (survey_mean((vz03_3 < 3), na.rm = TRUE, vartype = vt) * 100),
    vz03_4 = (survey_mean((vz03_4 < 3), na.rm = TRUE, vartype = vt) * 100),
    vz03_5 = (survey_mean((vz03_5 < 3), na.rm = TRUE, vartype = vt) * 100),
    vz03_6 = (survey_mean((vz03_6 < 3), na.rm = TRUE, vartype = vt) * 100),
    vz03_7 = (survey_mean((vz03_7 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl02_0 = (survey_mean((wl02_0 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl02_1 = (survey_mean((wl02_1 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl02_2 = (survey_mean((wl02_2 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl03_0 = (survey_mean((wl03_0 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl03_1 = (survey_mean((wl03_1 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl03_2 = (survey_mean((wl03_2 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl07_0 = (survey_mean((wl07_0 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl07_1 = (survey_mean((wl07_1 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl08_0 = (survey_mean((wl08_0 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl08_1 = (survey_mean((wl08_1 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl12_0 = (survey_mean((wl12_0 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl12_1 = (survey_mean((wl12_1 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl12_2 = (survey_mean((wl12_2 < 3), na.rm = TRUE, vartype = vt) * 100),
    vz01_0 = (survey_mean((vz01_0 < 3), na.rm = TRUE, vartype = vt) * 100),
    vz01_1 = (survey_mean((vz01_1 < 3), na.rm = TRUE, vartype = vt) * 100),
    # vz02_0=(survey_mean((vz02_0<3), na.rm=TRUE,vartype=vt) *100),
    # vz02_1=(survey_mean((vz02_1<3), na.rm=TRUE,vartype=vt) *100),
    bo02_0 = (survey_mean((bo02_0 < 3), na.rm = TRUE, vartype = vt) * 100),
    bo02_1 = (survey_mean((bo02_1 < 3), na.rm = TRUE, vartype = vt) * 100),
    bo02_2 = (survey_mean((bo02_2 < 3), na.rm = TRUE, vartype = vt) * 100),
    bo03_0 = (survey_mean((bo03_0 < 3), na.rm = TRUE, vartype = vt) * 100),
    bo03_1 = (survey_mean((bo03_1 < 3), na.rm = TRUE, vartype = vt) * 100),
    # bo04_0=(survey_mean((bo04_0<3), na.rm=TRUE,vartype=vt) *100),
    dv07_0 = (survey_mean((dv07_0 < 3), na.rm = TRUE, vartype = vt) * 100),
    dv07_1 = (survey_mean((dv07_1 < 3), na.rm = TRUE, vartype = vt) * 100),
    dv07_2 = (survey_mean((dv07_2 < 3), na.rm = TRUE, vartype = vt) * 100),
    dv07_3 = (survey_mean((dv07_3 < 3), na.rm = TRUE, vartype = vt) * 100),
    dv05_0 = (survey_mean((dv05_0 < 3), na.rm = TRUE, vartype = vt) * 100),
    dv08_0 = (survey_mean((dv08_0 < 3), na.rm = TRUE, vartype = vt) * 100),
    dv09_0 = (survey_mean((dv09_0 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl04 = (survey_mean((wl04 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl05 = (survey_mean((wl05 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl06 = (survey_mean((wl06 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl09_rv = (survey_mean((wl09 == 4 | wl09 == 5), na.rm = TRUE, vartype = vt) * 100),
    wl09 = (survey_mean((wl09 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl14 = (survey_mean((wl14 < 3), na.rm = TRUE, vartype = vt) * 100),
    bo01_rv = (survey_mean((bo01 == 4 | bo01 == 5), na.rm = TRUE, vartype = vt) * 100),
    bo01 = (survey_mean((bo01 < 3), na.rm = TRUE, vartype = vt) * 100),
    zw00_pin = (survey_mean((zw00 > 6), na.rm = TRUE, vartype = vt) * 100),
    zw07 = (survey_mean((zw07 < 3), na.rm = TRUE, vartype = vt) * 100),
    mm01_0 = (survey_mean((mm01_0 < 3), na.rm = TRUE, vartype = vt) * 100),
    mm01_1 = (survey_mean((mm01_1 < 3), na.rm = TRUE, vartype = vt) * 100),
    mm01_2 = (survey_mean((mm01_2 < 3), na.rm = TRUE, vartype = vt) * 100),
    mm01_3 = (survey_mean((mm01_3 < 3), na.rm = TRUE, vartype = vt) * 100),
    mm01_4 = (survey_mean((mm01_4 < 3), na.rm = TRUE, vartype = vt) * 100),
    mm02_0 = (survey_mean((mm02_0 < 3), na.rm = TRUE, vartype = vt) * 100),
    wl13 = (survey_mean((wl13 == 1), na.rm = TRUE, vartype = vt) * 100),
    # new 23-01-03
    wl13_pin2 = (survey_mean((wl13 == 2), na.rm = TRUE, vartype = vt) * 100),
    # new 23-01-03
    wl13_pin3 = (survey_mean((wl13 == 3), na.rm = TRUE, vartype = vt) * 100),
    dv02 = (survey_mean((dv02 == 1), na.rm = TRUE, vartype = vt) * 100),
    zw05_rc = (survey_mean((zw05_4 == 0), na.rm = TRUE, vartype = vt) * 100),
    dv06_pin = (survey_mean((dv06 >= 1 & dv06 <= 5), na.rm = TRUE, vartype = vt) * 100),
    dv10_pin = (survey_mean((dv10 >= 1 & dv10 <= 5), na.rm = TRUE, vartype = vt) * 100),
    zw02_pin = (survey_mean((zw02 >= 1 & zw02 <= 5), na.rm = TRUE, vartype = vt) * 100),
    zw12_pin = (survey_mean((zw12 >= 1 & zw12 <= 5), na.rm = TRUE, vartype = vt) * 100),
    zw09 = (survey_mean((zw09 >= 3 & zw09 <= 4), na.rm = TRUE, vartype = vt) * 100),
    zw03 = (survey_mean((zw03 >= 2 & zw03 <= 3), na.rm = TRUE, vartype = vt) * 100),
    zw04_rv = (survey_mean((zw04 == 1), na.rm = TRUE, vartype = vt) * 100),
    zw04 = (survey_mean((zw04 >= 3 & zw04 <= 4), na.rm = TRUE, vartype = vt) * 100),
    zw04n = (survey_mean((zw04 >= 2 & zw04 <= 4), na.rm = TRUE, vartype = vt) * 100),
    sc02_pin = (survey_mean((sc02 >= 1 & sc02 <= 5), na.rm = TRUE, vartype = vt) * 100)
  ) %>%
  mutate_at(., vars(-group_cols()), ~ ifelse(is.nan(.) | is.infinite(.), NA, .)) %>%
  mutate_at(., vars(-group_cols()), ~ replace(., . == 0, NA))

# cols_to_remove<- grep("_se", names(df_aggr_pin))

df_aggr_pin <- df_aggr_pin %>%
  # select(-cols_to_remove) %>%
  # reorder variables
  select(sort(names(.))) %>%
  # move gemeente and metingsjaar to the front
  relocate(any_of(c("GEOITEM", "PERIOD")), .before = bo01)


#-----------------------------------------------------------------------------------------------
# reverse

df_rev_aggr_pin <- df_weight %>%
  group_by(GEOITEM, PERIOD) %>%
  srvyr::summarise(
    wl02_0_rv = (survey_mean((wl02_0 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    wl02_1_rv = (survey_mean((wl02_1 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    wl03_0_rv = (survey_mean((wl03_0 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    wl03_1_rv = (survey_mean((wl03_1 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    wl07_0_rv = (survey_mean((wl07_0 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    wl07_1_rv = (survey_mean((wl07_1 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    wl08_0_rv = (survey_mean((wl08_0 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    wl08_1_rv = (survey_mean((wl08_1 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    wl12_0_rv = (survey_mean((wl12_0 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    wl12_1_rv = (survey_mean((wl12_1 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    wl12_2_rv = (survey_mean((wl12_2 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    vz01_0_rv = (survey_mean((vz01_0 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    vz01_1_rv = (survey_mean((vz01_1 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    vz03_0_rv = (survey_mean((vz03_0 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    vz03_1_rv = (survey_mean((vz03_1 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    vz03_2_rv = (survey_mean((vz03_2 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    vz03_3_rv = (survey_mean((vz03_3 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    dv05_0_rv = (survey_mean((dv05_0 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    dv07_0_rv = (survey_mean((dv07_0 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    dv07_1_rv = (survey_mean((dv07_1 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    dv07_2_rv = (survey_mean((dv07_2 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    dv07_3_rv = (survey_mean((dv07_3 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    dv08_0_rv = (survey_mean((dv08_0 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    dv09_0_rv = (survey_mean((dv09_0 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    mm01_0_rv = (survey_mean((mm01_0 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    mm01_1_rv = (survey_mean((mm01_1 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    mm01_2_rv = (survey_mean((mm01_2 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    mm01_3_rv = (survey_mean((mm01_3 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    mm01_4_rv = (survey_mean((mm01_4 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    mm02_0_rv = (survey_mean((mm02_0 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    bo02_0_rv = (survey_mean((bo02_0 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    bo02_1_rv = (survey_mean((bo02_1 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    bo02_2_rv = (survey_mean((bo02_2 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    bo03_0_rv = (survey_mean((bo03_0 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100),
    bo03_1_rv = (survey_mean((bo03_1 %in% c(4, 5)), na.rm = TRUE, vartype = vt) * 100)
  )
